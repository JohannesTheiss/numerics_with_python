# Numerics with Python
Numerics with calculation way

![cool-figure](https://raw.githubusercontent.com/JohannesTheiss/numerics_with_python/main/screenshots/cool_graph.png)
---

## Interpolation
#### Input data
| i  | xi | fi |
| -- | -- | -- |
| 0  | -1 |  3 |
| 1  |  0 |  1 |
| 2  |  1 |  2 |
| 3  |  2 |  1 |

evaluation point: 0

### Plot: Lagrange, Neville and Newton
![cool-figure](https://raw.githubusercontent.com/JohannesTheiss/numerics_with_python/main/screenshots/Lagrange_neville_newton.png)

### Lagrange output
```
p(x):
                 3          2
-0.8333 x + 1.5 x + 0.3333 x + 1
coef:
[-5/6 = -0.833333333333333 = -0.83333333, 3/2 = 1.50000000000000 = 1.5, 1/3 = 0.333333333333333 = 0.33333333, 1 = 1.00000000000000 = 1.0]
p(0)    : 1.0
```

### Neville output
```
P 0,1 = (0 - -1.0) * 1.0  - (0 - 0.0)* 3.0 / (0.0 - -1.0)   = 1.0 = 1.0 = 1
P 1,2 = (0 - 0.0)  * 2.0  - (0 - 1.0)* 1.0 / (1.0 - 0.0)    = 1.0 = 1.0 = 1
P 2,3 = (0 - 1.0)  * 1.0  - (0 - 2.0)* 2.0 / (2.0 - 1.0)    = 3.0 = 3.0 = 3
P 0,2 = (0 - -1.0) * 1.0  - (0 - 1.0)* 1.0 / (1.0 - -1.0)   = 1.0 = 1.0 = 1
P 1,3 = (0 - 0.0)  * 3.0  - (0 - 2.0)* 1.0 / (2.0 - 0.0)    = 1.0 = 1.0 = 1
P 0,3 = (0 - -1.0) * 1.0  - (0 - 2.0)* 1.0 / (2.0 - -1.0)   = 1.0 = 1.0 = 1
P 0,3 = p(0) = 1.0
```

### Newton output
```
P 0,1 =  1.0 - 3.0              / (0.0 - -1.0)   = -2.0 = -2.0 = -2
P 1,2 =  2.0 - 1.0              / (1.0 - 0.0)    = 1.0 = 1.0 = 1
P 2,3 =  1.0 - 2.0              / (2.0 - 1.0)    = -1.0 = -1.0 = -1
P 0,2 =  1.0 - -2.0             / (1.0 - -1.0)   = 1.5 = 1.5 = 3/2
P 1,3 =  -1.0 - 1.0             / (2.0 - 0.0)    = -1.0 = -1.0 = -1
P 0,3 =  -1.0 - 1.5             / (2.0 - -1.0)   = -0.8333333333333334 = -0.8333333 = -5/6
coefs: [3.0, -2.0, 1.5, -0.8333333333333334]
p(0) = 1.00000000000000
newton poly:
(x + 1.0)⋅(x⋅(2.33333333333333 - 0.833333333333333⋅x) - 2.0) + 3.0
=
-(x + 1.0)⋅(x⋅(0.833333333333333⋅x - 2.33333333333333) + 2.0) + 3.0
=
        ⎛  ⎛7   5⋅x⎞    ⎞
(x + 1)⋅⎜x⋅⎜─ - ───⎟ - 2⎟ + 3
        ⎝  ⎝3    6 ⎠    ⎠
=
          ⎛  ⎛5⋅x   7⎞    ⎞
- (x + 1)⋅⎜x⋅⎜─── - ─⎟ + 2⎟ + 3
          ⎝  ⎝ 6    3⎠    ⎠
```

### Cubic spline
##### Plot: natural and complete spline
---
![cool-figure](https://raw.githubusercontent.com/JohannesTheiss/numerics_with_python/main/screenshots/cubic_natural_complete.png)
---
##### natural spline output
```
Interval: [(-1.0, 0.0), (0.0, 1.0), (1.0, 2.0)]
Si:

s1(x):
                                2               3
a₁ + b₁⋅(x + 1.0) + c₁⋅(x + 1.0)  + d₁⋅(x + 1.0)

s2(x):
                2       3
a₂ + b₂⋅x + c₂⋅x  + d₂⋅x

s3(x):
                                2               3
a₃ + b₃⋅(x - 1.0) + c₃⋅(x - 1.0)  + d₃⋅(x - 1.0)

derivative:
s1'(x)
                             2
b₁ + 2⋅c₁⋅x + 2.0⋅c₁ + 3⋅d₁⋅x  + 6.0⋅d₁⋅x + 3.0⋅d₁

s1''(x)
2⋅c₁ + 3⋅d₁⋅(2⋅x + 2.0)

s2'(x)
                    2
b₂ + 2⋅c₂⋅x + 3⋅d₂⋅x

s2''(x)
2⋅c₂ + 6⋅d₂⋅x

s3'(x)
                             2
b₃ + 2⋅c₃⋅x - 2.0⋅c₃ + 3⋅d₃⋅x  - 6.0⋅d₃⋅x + 3.0⋅d₃

s3''(x)
2⋅c₃ + 3⋅d₃⋅(2⋅x - 2.0)

conditions:
b₁ + 2.0⋅c₁ + 3.0⋅d₁ = b₂
2⋅c₁ + 6.0⋅d₁ = 2⋅c₂
b₂ + 2.0⋅c₂ + 3.0⋅d₂ = b₃
2⋅c₂ + 6.0⋅d₂ = 2⋅c₃
a₁ = 3.0
a₁ + 1.0⋅b₁ + 1.0⋅c₁ + 1.0⋅d₁ = 1.0
a₂ = 1.0
a₂ + 1.0⋅b₂ + 1.0⋅c₂ + 1.0⋅d₂ = 2.0
a₃ = 2.0
a₃ + 1.0⋅b₃ + 1.0⋅c₃ + 1.0⋅d₃ = 1.0

natural spline
2⋅c₁ = 0
2⋅c₃ + 6.0⋅d₃ = 0

RESULTS:
LGS:
b₁ + 2.0⋅c₁ + 3.0⋅d₁ = b₂
2⋅c₁ + 6.0⋅d₁ = 2⋅c₂
b₂ + 2.0⋅c₂ + 3.0⋅d₂ = b₃
2⋅c₂ + 6.0⋅d₂ = 2⋅c₃
a₁ = 3.0
a₁ + 1.0⋅b₁ + 1.0⋅c₁ + 1.0⋅d₁ = 1.0
a₂ = 1.0
a₂ + 1.0⋅b₂ + 1.0⋅c₂ + 1.0⋅d₂ = 2.0
a₃ = 2.0
a₃ + 1.0⋅b₃ + 1.0⋅c₃ + 1.0⋅d₃ = 1.0
2⋅c₁ = 0
2⋅c₃ + 6.0⋅d₃ = 0

solved LGS:
{a₁: 3.0, a₂: 1.0, a₃: 2.0, b₁: -2.93333333333333, b₂: -0.133333333333333, b₃: 0.466666666666667, c₁: 0.0, c₂: 2.8, c₃: -2.2, d₁: 0.933333333333333, d₂: -1.66666666666667, d₃: 0.733333333333333}
=
⎧                         -44                                                        14                11⎫
⎨a₁: 3, a₂: 1, a₃: 2, b₁: ────, b₂: -2/15, b₃: 7/15, c₁: 0, c₂: 14/5, c₃: -11/5, d₁: ──, d₂: -5/3, d₃: ──⎬
⎩                          15                                                        15                15⎭

S1: interval: (-1.0, 0.0)
                                                 3
-2.93333333333333⋅x + 0.933333333333333⋅(x + 1.0)  + 0.0666666666666669
=
                                                 3
-2.93333333333333⋅x + 0.933333333333333⋅(x + 1.0)  + 0.0666666666666669
=
                   3
  44⋅x   14⋅(x + 1)    1
- ──── + ─────────── + ──
   15         15       15

S2: interval: (0.0, 1.0)
                    3        2
- 1.66666666666667⋅x  + 2.8⋅x  - 0.133333333333333⋅x + 1.0
=
                    3        2
- 1.66666666666667⋅x  + 2.8⋅x  - 0.133333333333333⋅x + 1.0
=
     3       2
  5⋅x    14⋅x    2⋅x
- ──── + ───── - ─── + 1
   3       5      15

S3: interval: (1.0, 2.0)
                                                 3                2
0.466666666666667⋅x + 0.733333333333333⋅(x - 1.0)  - 2.2⋅(x - 1.0)  + 1.53333333333333
=
                   3        2
0.733333333333333⋅x  - 4.4⋅x  + 7.06666666666667⋅x - 1.4
=
    3       2
11⋅x    22⋅x    106⋅x   7
───── - ───── + ───── - ─
  15      5       15    5

```

##### complete spline output
```
Interval: [(-1.0, 0.0), (0.0, 1.0), (1.0, 2.0)]
Si:

s1(x):
                                2               3
a₁ + b₁⋅(x + 1.0) + c₁⋅(x + 1.0)  + d₁⋅(x + 1.0)

s2(x):
                2       3
a₂ + b₂⋅x + c₂⋅x  + d₂⋅x

s3(x):
                                2               3
a₃ + b₃⋅(x - 1.0) + c₃⋅(x - 1.0)  + d₃⋅(x - 1.0)

derivative:

s1'(x)
                             2
b₁ + 2⋅c₁⋅x + 2.0⋅c₁ + 3⋅d₁⋅x  + 6.0⋅d₁⋅x + 3.0⋅d₁

s1''(x)
2⋅c₁ + 3⋅d₁⋅(2⋅x + 2.0)

s2'(x)
                    2
b₂ + 2⋅c₂⋅x + 3⋅d₂⋅x

s2''(x)
2⋅c₂ + 6⋅d₂⋅x

s3'(x)
                             2
b₃ + 2⋅c₃⋅x - 2.0⋅c₃ + 3⋅d₃⋅x  - 6.0⋅d₃⋅x + 3.0⋅d₃

s3''(x)
2⋅c₃ + 3⋅d₃⋅(2⋅x - 2.0)

conditions:
b₁ + 2.0⋅c₁ + 3.0⋅d₁ = b₂
2⋅c₁ + 6.0⋅d₁ = 2⋅c₂
b₂ + 2.0⋅c₂ + 3.0⋅d₂ = b₃
2⋅c₂ + 6.0⋅d₂ = 2⋅c₃
a₁ = 3.0
a₁ + 1.0⋅b₁ + 1.0⋅c₁ + 1.0⋅d₁ = 1.0
a₂ = 1.0
a₂ + 1.0⋅b₂ + 1.0⋅c₂ + 1.0⋅d₂ = 2.0
a₃ = 2.0
a₃ + 1.0⋅b₃ + 1.0⋅c₃ + 1.0⋅d₃ = 1.0

complete spline
b₁ = -1.0
b₃ + 2.0⋅c₃ + 3.0⋅d₃ = 1.0

RESULTS:
LGS:
b₁ + 2.0⋅c₁ + 3.0⋅d₁ = b₂
2⋅c₁ + 6.0⋅d₁ = 2⋅c₂
b₂ + 2.0⋅c₂ + 3.0⋅d₂ = b₃
2⋅c₂ + 6.0⋅d₂ = 2⋅c₃
a₁ = 3.0
a₁ + 1.0⋅b₁ + 1.0⋅c₁ + 1.0⋅d₁ = 1.0
a₂ = 1.0
a₂ + 1.0⋅b₂ + 1.0⋅c₂ + 1.0⋅d₂ = 2.0
a₃ = 2.0
a₃ + 1.0⋅b₃ + 1.0⋅c₃ + 1.0⋅d₃ = 1.0
b₁ = -1.0
b₃ + 2.0⋅c₃ + 3.0⋅d₃ = 1.0

solved LGS:
{a₁: 3.0, a₂: 1.0, a₃: 2.0, b₁: -1.0, b₂: -0.466666666666667, b₃: -0.133333333333333, c₁: -3.53333333333333, c₂: 4.06666666666667, c₃: -3.73333333333333, d₁: 2.53333333333333, d₂: -2.6, d₃: 2.86666666666667}
=
⎧                                                       -53       61      -56       38                 43⎫
⎨a₁: 3, a₂: 1, a₃: 2, b₁: -1, b₂: -7/15, b₃: -2/15, c₁: ────, c₂: ──, c₃: ────, d₁: ──, d₂: -13/5, d₃: ──⎬
⎩                                                        15       15       15       15                 15⎭

S1: interval: (-1.0, 0.0)
                               3                             2
-x + 2.53333333333333⋅(x + 1.0)  - 3.53333333333333⋅(x + 1.0)  + 2.0
=
                  3                     2
2.53333333333333⋅x  + 4.06666666666667⋅x  - 0.466666666666667⋅x + 1.0
=
    3       2
38⋅x    61⋅x    7⋅x
───── + ───── - ─── + 1
  15      15     15

S2: interval: (0.0, 1.0)
       3                     2
- 2.6⋅x  + 4.06666666666667⋅x  - 0.466666666666667⋅x + 1.0
=
       3                     2
- 2.6⋅x  + 4.06666666666667⋅x  - 0.466666666666667⋅x + 1.0
=
      3       2
  13⋅x    61⋅x    7⋅x
- ───── + ───── - ─── + 1
    5       15     15

S3: interval: (1.0, 2.0)
                                                 3                             2
-0.133333333333333⋅x + 2.86666666666667⋅(x - 1.0)  - 3.73333333333333⋅(x - 1.0)  + 2.13333333333333
=
                  3                     2
2.86666666666667⋅x  - 12.3333333333333⋅x  + 15.9333333333333⋅x - 4.46666666666667
=
    3       2
43⋅x    37⋅x    239⋅x   67
───── - ───── + ───── - ──
  15      3       15    15
```
##### periodic spline plot
![cool-figure](https://raw.githubusercontent.com/JohannesTheiss/numerics_with_python/main/screenshots/cubic_periodic.png)
##### periodic spline output
###### Input data (f(x) = |x|):
| i  | xi | fi |
| -- | -- | -- |
| 0  | -1 |  1 |
| 1  |  0 |  0 |
| 2  |  1 |  1 |

```
Interval: [(-1.0, 0.0), (0.0, 1.0)]
Si:

s1(x):
                                2               3
a₁ + b₁⋅(x + 1.0) + c₁⋅(x + 1.0)  + d₁⋅(x + 1.0)

s2(x):
                2       3
a₂ + b₂⋅x + c₂⋅x  + d₂⋅x

derivative:

s1'(x)
                             2
b₁ + 2⋅c₁⋅x + 2.0⋅c₁ + 3⋅d₁⋅x  + 6.0⋅d₁⋅x + 3.0⋅d₁

s1''(x)
2⋅c₁ + 3⋅d₁⋅(2⋅x + 2.0)

s2'(x)
                    2
b₂ + 2⋅c₂⋅x + 3⋅d₂⋅x

s2''(x)
2⋅c₂ + 6⋅d₂⋅x

conditions:
b₁ + 2.0⋅c₁ + 3.0⋅d₁ = b₂
2⋅c₁ + 6.0⋅d₁ = 2⋅c₂
a₁ = 1.0
a₁ + 1.0⋅b₁ + 1.0⋅c₁ + 1.0⋅d₁ = 0.0
a₂ = 0.0
a₂ + 1.0⋅b₂ + 1.0⋅c₂ + 1.0⋅d₂ = 1.0

periodic spline
b₁ = b₂ + 2.0⋅c₂ + 3.0⋅d₂
2⋅c₁ = 2⋅c₂ + 6.0⋅d₂

RESULTS:
LGS:
b₁ + 2.0⋅c₁ + 3.0⋅d₁ = b₂
2⋅c₁ + 6.0⋅d₁ = 2⋅c₂
a₁ = 1.0
a₁ + 1.0⋅b₁ + 1.0⋅c₁ + 1.0⋅d₁ = 0.0
a₂ = 0.0
a₂ + 1.0⋅b₂ + 1.0⋅c₂ + 1.0⋅d₂ = 1.0
b₁ = b₂ + 2.0⋅c₂ + 3.0⋅d₂
2⋅c₁ = 2⋅c₂ + 6.0⋅d₂

solved LGS:
{a₁: 1.0, a₂: 0.0, b₁: 0.0, b₂: 0.0, c₁: -3.0, c₂: 3.0, d₁: 2.0, d₂: -2.0}
=
{a₁: 1, a₂: 0, b₁: 0, b₂: 0, c₁: -3, c₂: 3, d₁: 2, d₂: -2}

S1: interval: (-1.0, 0.0)
             3                2
2.0⋅(x + 1.0)  - 3.0⋅(x + 1.0)  + 1.0
=
 2
x ⋅(2.0⋅x + 3.0)
=
 2
x ⋅(2⋅x + 3)

S2: interval: (0.0, 1.0)
       3        2
- 2.0⋅x  + 3.0⋅x
=
 2
x ⋅(3.0 - 2.0⋅x)
=
 2
x ⋅(3 - 2⋅x)
```